[
    {
        "op": "core/transpose-columns-into-rows",
        "combinedColumnName": "All 856$u",
        "startColumnName": "856$u",
        "columnCount": -1,
        "ignoreBlankCells": true,
        "fillDown": false,
        "prependColumnName": true,
        "separator": "|",
        "keyColumnName": null,
        "valueColumnName": null,
        "description": "Pivot all 856$u columns into one new column named ``All 856$u`` with the original column name in front separated by a pipe"
    },
    {
        "op": "core/column-split",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "All 856$u",
        "guessCellType": false,
        "removeOriginalColumn": true,
        "mode": "separator",
        "separator": "|",
        "regex": false,
        "maxColumns": 2,
        "description": "Split column ``All 856$u`` at the first pipe"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "All 856$u 1",
        "expression": "grel:if(isNull(cells[\"856$3\"].value),value,cells[\"856$3\"].value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "If a 856$3 [or 856$z] value is available, use that to replace the value in column ``All 856$u 1``"
    },
    {
        "op": "core/column-removal",
        "columnName": "856$3",
        "description": "Remove column ``856$3``"
    },
    {
        "op": "core/column-addition",
        "description": "Create column ``Count`` to keep all values during the pivot",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "newColumnName": "Count",
        "columnInsertIndex": 1,
        "baseColumnName": "SYS Number",
        "expression": "grel:row.record.cells[\"SYS Number\"].value[0]+\"-\"+toString(row.index-row.record.fromRowIndex+1)",
        "onError": "set-to-blank"
    }
]