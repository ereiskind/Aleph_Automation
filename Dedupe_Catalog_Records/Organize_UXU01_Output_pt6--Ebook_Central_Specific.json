













    {
        "op": "core/blank-down",
        "description": "Blank down cells in column ``Inexact Title Record Number``",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Inexact Title Record Number"
    },
    {
        "op": "core/blank-down",
        "description": "Blank down cells in column ``No Subtitle Record Number``",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "No Subtitle Record Number"
    },
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``BIB Number`` in a record in the first row of the record divided by `]}|{[`",
        "columnName": "BIB Number",
        "keyColumnName": "Title Record Number",
        "separator": "]}|{["
    },
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``Title`` in a record in the first row of the record divided by `]}|{[`",
        "columnName": "Title",
        "keyColumnName": "Title Record Number",
        "separator": "]}|{["
    },
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``ID`` in a record in the first row of the record divided by `]}|{[`",
        "columnName": "ID",
        "keyColumnName": "Title Record Number",
        "separator": "]}|{["
    },
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``ISBN Value`` in a record in the first row of the record divided by `]}|{[`",
        "columnName": "ISBN Value",
        "keyColumnName": "Title Record Number",
        "separator": "]}|{["
    }
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``Inexact Title Record Number`` in a record in the first row of the record divided by pipes",
        "columnName": "Inexact Title Record Number",
        "keyColumnName": "Title Record Number",
        "separator": "|"
    }
    {
        "op": "core/text-transform",
        "description": "Null blank cells in column ``Inexact Title Record Number``",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Inexact Title Record Number",
                    "expression": "isBlank(value)",
                    "columnName": "Inexact Title Record Number",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": true,
                                "l": "true"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "row-based"
        },
        "columnName": "Inexact Title Record Number",
        "expression": "null",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    }
    {
        "op": "core/multivalued-cell-join",
        "description": "Combine all values in column ``No Subtitle Record Number`` in a record in the first row of the record divided by pipes",
        "columnName": "No Subtitle Record Number",
        "keyColumnName": "Title Record Number",
        "separator": "|"
    }
    {
        "op": "core/text-transform",
        "description": "Null blank cells in column ``No Subtitle Record Number``",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "No Subtitle Record Number",
                    "expression": "isBlank(value)",
                    "columnName": "No Subtitle Record Number",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": true,
                                "l": "true"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "row-based"
        },
        "columnName": "No Subtitle Record Number",
        "expression": "null",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    }
    {
        "op": "core/column-removal",
        "description": "Remove column ``Title Record Number``",
        "columnName": "Title Record Number"
    }


















{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``Trimmed Title Record Number`` into new rows at pipes",
    "columnName": "Trimmed Title Record Number",
    "keyColumnName": "BIB Number",
    "mode": "separator",
    "separator": "|",
    "regex": false
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``ISBN Value``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ISBN Value"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``ID``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ID"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Title``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Title"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``BIB Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "BIB Number"
},
{
    "op": "core/row-reorder",
    "description": "Reorder rows based on ``Trimmed Title Record Number``",
    "mode": "record-based",
    "sorting": {
        "criteria": [
            {
                "valueType": "string",
                "column": "Trimmed Title Record Number",
                "blankPosition": 2,
                "errorPosition": 1,
                "reverse": false,
                "caseSensitive": false
            }
        ]
    }
},
{
    "op": "core/text-transform",
    "description": "Fill null values in column ``Trimmed Title Record Number`` with `Row` and the record number",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Trimmed Title Record Number",
    "expression": "grel:if(isNull(value),\"Row\"+toString(row.record.index+1),value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
},
{
    "op": "core/column-move",
    "description": "Move column ``Trimmed Title Record Number`` to beginning of table",
    "columnName": "Trimmed Title Record Number",
    "index": 0
},
{
    "op": "core/blank-down",
    "description": "Blank down cells in column ``Trimmed Title Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "Trimmed Title Record Number"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``BIB Number`` in a record in the first row of the record divided by `]}|{[`",
    "columnName": "BIB Number",
    "keyColumnName": "Trimmed Title Record Number",
    "separator": "]}|{["
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Title`` in a record in the first row of the record divided by `]}|{[`",
    "columnName": "Title",
    "keyColumnName": "Trimmed Title Record Number",
    "separator": "]}|{["
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``ID`` in a record in the first row of the record divided by `]}|{[`",
    "columnName": "ID",
    "keyColumnName": "Trimmed Title Record Number",
    "separator": "]}|{["
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``ISBN Value`` in a record in the first row of the record divided by `]}|{[`",
    "columnName": "ISBN Value",
    "keyColumnName": "Trimmed Title Record Number",
    "separator": "]}|{["
}
{
    "op": "core/column-removal",
    "description": "Remove column ``Trimmed Title Record Number``",
    "columnName": "Trimmed Title Record Number"
},
{
    "op": "core/column-addition",
    "description": "Create column ``Record Number`` containing the number of the record",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "baseColumnName": "BIB Number",
    "expression": "grel:row.record.index+1",
    "onError": "set-to-blank",
    "newColumnName": "Record Number",
    "columnInsertIndex": 0
}
{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``BIB Number`` into new rows at `]}|{[``",
    "columnName": "BIB Number",
    "keyColumnName": "Record Number",
    "mode": "separator",
    "separator": "]}|{[",
    "regex": false
}
{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``Title`` into new rows at `]}|{[``",
    "columnName": "Title",
    "keyColumnName": "Record Number",
    "mode": "separator",
    "separator": "]}|{[",
    "regex": false
},
{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``ID`` into new rows at `]}|{[``",
    "columnName": "ID",
    "keyColumnName": "Record Number",
    "mode": "separator",
    "separator": "]}|{[",
    "regex": false
},
{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``ISBN Value`` into new rows at `]}|{[``",
    "columnName": "ISBN Value",
    "keyColumnName": "Record Number",
    "mode": "separator",
    "separator": "]}|{[",
    "regex": false
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Record Number"
},
{
    "op": "core/column-move",
    "description": "Move column ``BIB Number`` to beginning of table",
    "columnName": "BIB Number",
    "index": 0
}
{
    "op": "core/column-addition",
    "description": "Create column ``Dedupe`` combining values of ``BIB Number`` and ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "baseColumnName": "BIB Number",
    "expression": "grel:value+\"-\"+cells[\"Record Number\"].value",
    "onError": "set-to-blank",
    "newColumnName": "Dedupe",
    "columnInsertIndex": 1
},
{
    "op": "core/row-reorder",
    "description": "Reorder rows based on ``Dedupe``",
    "mode": "record-based",
    "sorting": {
        "criteria": [
            {
                "valueType": "string",
                "column": "Dedupe",
                "blankPosition": 2,
                "errorPosition": 1,
                "reverse": false,
                "caseSensitive": false
            }
        ]
    }
},
{
    "op": "core/blank-down",
    "description": "Blank down cells in column ``Dedupe``",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "Dedupe"
},
{
    "op": "core/row-removal",
    "description": "Remove rows with no value in ``Dedupe``",
    "engineConfig": {
        "facets": [
            {
                "type": "list",
                "name": "Dedupe",
                "expression": "isBlank(value)",
                "columnName": "Dedupe",
                "invert": false,
                "omitBlank": false,
                "omitError": false,
                "selection": [
                    {
                        "v": {
                            "v": true,
                            "l": "true"
                        }
                    }
                ],
                "selectBlank": false,
                "selectError": false
            }
        ],
        "mode": "row-based"
    }
}
{
    "op": "core/column-removal",
    "description": "Remove column ``Dedupe``",
    "columnName": "Dedupe"
},
{
    "op": "core/row-reorder",
    "description": "Reorder rows based on ``Record Number``",
    "mode": "record-based",
    "sorting": {
        "criteria": [
            {
                "valueType": "number",
                "column": "Record Number",
                "blankPosition": 2,
                "errorPosition": 1,
                "reverse": false
            }
        ]
    }
}
{
    "op": "core/multivalued-cell-split",
    "description": "Split values in column ``ID`` into new rows at `}|{``",
    "columnName": "ID",
    "keyColumnName": "BIB Number",
    "mode": "separator",
    "separator": "}|{",
    "regex": false
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``ISBN Value``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ISBN Value"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Title``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Title"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Record Number"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``BIB Number``",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "BIB Number"
},
{
    "op": "core/text-transform",
    "description": "Revert string `null` in ``ID`` back to null value",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ID",
    "expression": "grel:if(value==\"null\",null,value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
},
{
    "op": "core/text-transform",
    "description": "Revert string `null` in ``ISBN Value`` back to null value",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ISBN Value",
    "expression": "grel:if(value==\"null\",null,value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
},
{
    "op": "core/column-move",
    "description": "Move column ``Record Number`` to beginning of table",
    "columnName": "Record Number",
    "index": 0
}
{
    "op": "core/column-split",
    "description": "Split column ``ID`` at `]|[`",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ID",
    "guessCellType": false,
    "removeOriginalColumn": false,
    "mode": "separator",
    "separator": "]|[",
    "regex": false,
    "maxColumns": 0
}
{
    "op": "core/blank-down",
    "description": "Blank down cells in column ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "Record Number"
}
{
    "op": "core/text-transform",
    "description": "Remove hash from end of values in column ``ID 1``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "ID 1",
    "expression": "grel:if(endsWith(value,\"#\"),substring(value,0,-1),value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
}
{
    "op": "core/key-value-columnize",
    "description": "Pivot table to create columns for values in ``ID 1`` containing the values in ``ID 2``",
    "keyColumnName": "ID 1",
    "valueColumnName": "ID 2",
    "noteColumnName": ""
},
{
    "op": "core/column-addition",
    "description": "Create column ``Ebook Central ID`` by filling up and down value of ``Ebook Central``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "baseColumnName": "Ebook Central",
    "expression": "grel:row.record.cells[\"Ebook Central\"].value[0]",
    "onError": "set-to-blank",
    "newColumnName": "Ebook Central ID",
    "columnInsertIndex": 3
},
{
    "op": "core/text-transform",
    "description": "Null values in column ``Ebook Central`` equal  to that row's value in ``Ebook Central ID``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Ebook Central",
    "expression": "grel:if(value==cells[\"Ebook Central ID\"].value,null,value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
}
{
    "op": "core/column-addition",
    "description": "Create column ``Exact Match via Ebook Central ID`` containing the record number in only those records that have exactly one Ebook Central ID",
    "engineConfig": {
        "facets": [
            {
                "type": "list",
                "name": "Ebook Central",
                "expression": "isBlank(value)",
                "columnName": "Ebook Central",
                "invert": true,
                "omitBlank": false,
                "omitError": false,
                "selection": [
                    {
                        "v": {
                            "v": false,
                            "l": "false"
                        }
                    }
                ],
                "selectBlank": false,
                "selectError": false
            },
            {
                "type": "list",
                "name": "Ebook Central ID",
                "expression": "isBlank(value)",
                "columnName": "Ebook Central ID",
                "invert": false,
                "omitBlank": false,
                "omitError": false,
                "selection": [
                    {
                        "v": {
                            "v": false,
                            "l": "false"
                        }
                    }
                ],
                "selectBlank": false,
                "selectError": false
            }
        ],
        "mode": "record-based"
    },
    "baseColumnName": "BIB Number",
    "expression": "grel:row.record.index+1",
    "onError": "set-to-blank",
    "newColumnName": "Exact Match via Ebook Central ID",
    "columnInsertIndex": 1
}
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Record Number"
},
{
    "op": "core/column-move",
    "description": "Move column ``BIB Number`` to beginning of table",
    "columnName": "BIB Number",
    "index": 0
},
{
    "op": "core/blank-down",
    "description": "Blank down cells in column ``BIB Number``",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "BIB Number"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``OCLC`` in a record in the first row of the record divided by pipes",
    "columnName": "OCLC",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``OCLC``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "OCLC"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``MyiLibrary`` in a record in the first row of the record divided by pipes",
    "columnName": "MyiLibrary",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``MyiLibrary``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "MyiLibrary"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Ebrary`` in a record in the first row of the record divided by pipes",
    "columnName": "Ebrary",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Ebrary``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Ebrary"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Ebook Library`` in a record in the first row of the record divided by pipes",
    "columnName": "Ebook Library",
    "keyColumnName": "BIB Number",
    "separator": "|",
    "description": "Join multi-valued cells in column Ebook Library"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Ebook Library``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Ebook Library"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Ebook Central`` in a record in the first row of the record divided by pipes",
    "columnName": "Ebook Central",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Ebook Central``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Ebook Central"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Bibliographic Data Services`` in a record in the first row of the record divided by pipes",
    "columnName": "Bibliographic Data Services",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Bibliographic Data Services``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Bibliographic Data Services"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``YBP-long`` in a record in the first row of the record divided by pipes",
    "columnName": "YPB-long",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``YBP-long``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "YPB-long"
}
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``YBP`` in a record in the first row of the record divided by pipes",
    "columnName": "YBP",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``YBP``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "YBP"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``SIAM`` in a record in the first row of the record divided by pipes",
    "columnName": "SIAM",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``SIAM``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "SIAM"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Credo`` in a record in the first row of the record divided by pipes",
    "columnName": "Credo",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Credo``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Credo"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``Oxford UP`` in a record in the first row of the record divided by pipes",
    "columnName": "Oxford UP",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``Oxford UP``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Oxford UP"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``DOI`` in a record in the first row of the record divided by pipes",
    "columnName": "DOI",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``DOI``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "DOI"
},
{
    "op": "core/multivalued-cell-join",
    "description": "Combine all values in column ``APA`` in a record in the first row of the record divided by pipes",
    "columnName": "APA",
    "keyColumnName": "BIB Number",
    "separator": "|"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``APA``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "APA"
},
{
    "op": "core/column-removal",
    "description": "Remove column ``ID``",
    "columnName": "ID"
}
{
    "op": "core/blank-down",
    "description": "Blank down cells in column ``Record Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "Record Number"
},
{
    "op": "core/fill-down",
    "description": "Fill down cells in column ``BIB Number``",
    "engineConfig": {
        "facets": [],
        "mode": "record-based"
    },
    "columnName": "BIB Number"
},
{
    "op": "core/row-removal",
    "description": "Remove rows with null value in ``Record Number``",
    "engineConfig": {
        "facets": [
            {
                "type": "list",
                "name": "Record Number",
                "expression": "isBlank(value)",
                "columnName": "Record Number",
                "invert": false,
                "omitBlank": false,
                "omitError": false,
                "selection": [
                    {
                        "v": {
                            "v": true,
                            "l": "true"
                        }
                    }
                ],
                "selectBlank": false,
                "selectError": false
            }
        ],
        "mode": "row-based"
    }
}
{
    "op": "core/blank-down",
    "description": "Blank down cells in column BIB Number",
    "engineConfig": {
        "facets": [],
        "mode": "row-based"
    },
    "columnName": "BIB Number"
}
]

contains(value,"ï¿½")