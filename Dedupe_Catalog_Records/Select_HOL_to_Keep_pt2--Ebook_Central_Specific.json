[
    {
        "op": "core/text-transform",
        "description": "Null all blank cells in column ``Title Check 2``",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "isBlank(value)",
                    "columnName": "Title Check 1",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": false,
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 2",
                    "expression": "isBlank(value)",
                    "columnName": "Title Check 2",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": true,
                                "l": "true"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "row-based"
        },
        "columnName": "Title Check 2",
        "expression": "null",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    },
    {
        "op": "core/column-removal",
        "description": "Remove column ``Title Check 3``",
        "columnName": "Title Check 3"
    },
    {
        "op": "core/text-transform",
        "description": "Null values in column ``Title Check 1`` for records where all values in both ``Title Check 1`` and ``Title Check 2`` match",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "isBlank(value)",
                    "columnName": "Title Check 1",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": false,
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "grel:toString(row.record.cells[\"Title Check 1\"].value[0]==value)",
                    "columnName": "Title Check 1",
                    "invert": true,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "false",
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 2",
                    "expression": "grel:toString(row.record.cells[\"Title Check 2\"].value[0]==value)",
                    "columnName": "Title Check 2",
                    "invert": true,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "false",
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": true
                }
            ],
            "mode": "record-based"
        },
        "columnName": "Title Check 1",
        "expression": "null",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    }
    {
        "op": "core/text-transform",
        "description": "For records where all the values in ``Title Check 1`` match, change null values in column ``Title Check 2`` to `null`",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "isBlank(value)",
                    "columnName": "Title Check 1",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": false,
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "grel:toString(row.record.cells[\"Title Check 1\"].value[0]==value)",
                    "columnName": "Title Check 1",
                    "invert": true,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "false",
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "record-based"
        },
        "columnName": "Title Check 2",
        "expression": "grel:if(isNull(value),\"null\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    },
    {
        "op": "core/multivalued-cell-join",
        "description": "For records where all the values in ``Title Check 1`` match, combine all the values in column ``Title Check 2`` in the first row of the column seperated by pipes",
        "columnName": "Title Check 2",
        "keyColumnName": "Ebook Central ID",
        "separator": "|"
    },
    {
        "op": "core/text-transform",
        "description": "For records where all the values in ``Title Check 1`` match and all the values in ``Title Check 2`` were either null or `ed 1`, null the value in ``Title Check 1``",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "isBlank(value)",
                    "columnName": "Title Check 1",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": false,
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 1",
                    "expression": "grel:toString(row.record.cells[\"Title Check 1\"].value[0]==value)",
                    "columnName": "Title Check 1",
                    "invert": true,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "false",
                                "l": "false"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                },
                {
                    "type": "list",
                    "name": "Title Check 2",
                    "expression": "grel:toString(or(value==\"null|ed 1\",value==\"ed 1|null\"))",
                    "columnName": "Title Check 2",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "true",
                                "l": "true"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "record-based"
        },
        "columnName": "Title Check 1",
        "expression": "null",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10
    },
    {
        "op": "core/multivalued-cell-split",
        "description": "For records where all the values in ``Title Check 1`` match, split values in first row of column ``Title Check 2`` at pipes into seperate rows",
        "columnName": "Title Check 2",
        "keyColumnName": "Ebook Central ID",
        "mode": "separator",
        "separator": "|",
        "regex": false
    }
]